<!DOCTYPE html>
<html lang="en">
  <head>
    <title>PostgresClientKit  Reference</title>
    <link rel="stylesheet" type="text/css" href="css/jazzy.css" />
    <link rel="stylesheet" type="text/css" href="css/highlight.css" />
    <meta charset='utf-8'>
	<meta name="viewport" content="width=device-width, viewport-fit=cover, initial-scale=1.0" />
    <script src="js/jquery.min.js" defer></script>
    <script src="js/jazzy.js" defer></script>
    
  </head>
  <body>
    <a title="PostgresClientKit  Reference"></a>
    <header>
      <div class="content-wrapper">
        <p>
          <a href="index.html">PostgresClientKit Docs</a>
          <span class="no-mobile"> (100% documented)</span>
        </p>
    
    
      </div>
    </header>
    <div id="breadcrumbs-container">
      <div class="content-wrapper">
        <p id="breadcrumbs">
          <span class="no-mobile">
            <a href="index.html">PostgresClientKit Reference</a>
            <img id="carat" src="img/carat.png" />
          </span>
          PostgresClientKit  Reference
        </p>
      </div>
    </div>
    <div class="wrapper">
      <div class="article-wrapper">
        <article class="main-content">
          <section>
            <section class="section">
              
              <h1 id='postgresclientkit' class='heading'>PostgresClientKit</h1>

<p>PostgresClientKit provides a friendly Swift API for for operating against a PostgresSQL database.</p>
<h2 id='features' class='heading'>Features</h2>

<ul>
<li><p><strong>Doesn&rsquo;t require libpq.</strong>  PostgresClientKit implements the Postgres network protocol in Swift, so it does not require <code>libpq</code>.</p></li>
<li><p><strong>Developer-friendly API using modern Swift.</strong>  For example, errors are represented by instances of <code>enum PostgresError: Error</code> and are raised by a <code>throw</code> or by returning a <a href="https://github.com/apple/swift-evolution/blob/master/proposals/0235-add-result.md"><code>Result&lt;Success, Error&gt;</code></a>.</p></li>
<li><p><strong>Safe conversion between Postgres and Swift types.</strong> Type conversion is explicit and robust.  Conversion errors are signaled, not masked.  Additional Swift types for date/time values address the impedance mismatch between Postgres types and Foundation <code>Date</code>.</p></li>
<li><p><strong>Memory efficient.</strong> The rows in a result are exposed through an iterator, not an array.  Rows are lazily retrieved from the Postgres server.</p></li>
<li><p><strong>SSL/TLS support.</strong> Encrypts the connection between PostgresClientKit and the Postgres server.</p></li>
<li><p><strong>Well-engineered</strong>.  Complete API documentation, an extensive test suite, actively supported.</p></li>
</ul>

<p>Sounds good?  Let&rsquo;s look at an example.</p>
<h2 id='example' class='heading'>Example</h2>

<p>This is a basic, but complete, example of how to connect to Postgres, perform a SQL <code>SELECT</code> command, and process the resulting rows.  It uses the <code>weather</code> table in the <a href="https://www.postgresql.org/docs/11/tutorial-table.html">Postgres tutorial</a>.</p>
<pre class="highlight swift"><code><span class="kd">import</span> <span class="kt">PostgresClientKit</span>

<span class="k">do</span> <span class="p">{</span>
    <span class="k">var</span> <span class="nv">configuration</span> <span class="o">=</span> <span class="kt">PostgresClientKit</span><span class="o">.</span><span class="kt">ConnectionConfiguration</span><span class="p">()</span>
    <span class="n">configuration</span><span class="o">.</span><span class="n">host</span> <span class="o">=</span> <span class="s">"127.0.0.1"</span>
    <span class="n">configuration</span><span class="o">.</span><span class="n">ssl</span> <span class="o">=</span> <span class="kc">true</span>
    <span class="n">configuration</span><span class="o">.</span><span class="n">database</span> <span class="o">=</span> <span class="s">"example"</span>
    <span class="n">configuration</span><span class="o">.</span><span class="n">user</span> <span class="o">=</span> <span class="s">"bob"</span>
    <span class="n">configuration</span><span class="o">.</span><span class="n">credential</span> <span class="o">=</span> <span class="o">.</span><span class="nf">md5Password</span><span class="p">(</span><span class="nv">password</span><span class="p">:</span> <span class="s">"welcome1"</span><span class="p">)</span>

    <span class="k">let</span> <span class="nv">connection</span> <span class="o">=</span> <span class="k">try</span> <span class="kt">PostgresClientKit</span><span class="o">.</span><span class="kt">Connection</span><span class="p">(</span><span class="nv">configuration</span><span class="p">:</span> <span class="n">configuration</span><span class="p">)</span>
    <span class="k">defer</span> <span class="p">{</span> <span class="n">connection</span><span class="o">.</span><span class="nf">close</span><span class="p">()</span> <span class="p">}</span>

    <span class="k">let</span> <span class="nv">text</span> <span class="o">=</span> <span class="s">"SELECT city, temp_lo, temp_hi, prcp, date FROM weather WHERE city = $1;"</span>
    <span class="k">let</span> <span class="nv">statement</span> <span class="o">=</span> <span class="k">try</span> <span class="n">connection</span><span class="o">.</span><span class="nf">prepareStatement</span><span class="p">(</span><span class="nv">text</span><span class="p">:</span> <span class="n">text</span><span class="p">)</span>
    <span class="k">defer</span> <span class="p">{</span> <span class="n">statement</span><span class="o">.</span><span class="nf">close</span><span class="p">()</span> <span class="p">}</span>

    <span class="k">let</span> <span class="nv">cursor</span> <span class="o">=</span> <span class="k">try</span> <span class="n">statement</span><span class="o">.</span><span class="nf">execute</span><span class="p">(</span><span class="nv">parameterValues</span><span class="p">:</span> <span class="p">[</span> <span class="s">"San Francisco"</span> <span class="p">])</span>
    <span class="k">defer</span> <span class="p">{</span> <span class="n">cursor</span><span class="o">.</span><span class="nf">close</span><span class="p">()</span> <span class="p">}</span>

    <span class="k">for</span> <span class="n">row</span> <span class="k">in</span> <span class="n">cursor</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">columns</span> <span class="o">=</span> <span class="k">try</span> <span class="n">row</span><span class="o">.</span><span class="nf">get</span><span class="p">()</span><span class="o">.</span><span class="n">columns</span>
        <span class="k">let</span> <span class="nv">city</span> <span class="o">=</span> <span class="k">try</span> <span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="nf">string</span><span class="p">()</span>
        <span class="k">let</span> <span class="nv">tempLo</span> <span class="o">=</span> <span class="k">try</span> <span class="n">columns</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="nf">int</span><span class="p">()</span>
        <span class="k">let</span> <span class="nv">tempHi</span> <span class="o">=</span> <span class="k">try</span> <span class="n">columns</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="nf">int</span><span class="p">()</span>
        <span class="k">let</span> <span class="nv">prcp</span> <span class="o">=</span> <span class="k">try</span> <span class="n">columns</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="nf">optionalDouble</span><span class="p">()</span>
        <span class="k">let</span> <span class="nv">date</span> <span class="o">=</span> <span class="k">try</span> <span class="n">columns</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="nf">date</span><span class="p">()</span>

        <span class="nf">print</span><span class="p">(</span><span class="s">"""
            </span><span class="se">\(</span><span class="n">city</span><span class="se">)</span><span class="s"> on </span><span class="se">\(</span><span class="n">date</span><span class="se">)</span><span class="s">: low: </span><span class="se">\(</span><span class="n">tempLo</span><span class="se">)</span><span class="s">, high: </span><span class="se">\(</span><span class="n">tempHi</span><span class="se">)</span><span class="s">, </span><span class="err">\</span><span class="s">
            precipitation: </span><span class="se">\(</span><span class="kt">String</span><span class="p">(</span><span class="nv">describing</span><span class="p">:</span> <span class="n">prcp</span><span class="p">)</span><span class="se">)</span><span class="s">
            """</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span> <span class="k">catch</span> <span class="p">{</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">error</span><span class="p">)</span> <span class="c1">// better error handling goes here</span>
<span class="p">}</span>
</code></pre>

<p>Output:</p>
<pre class="highlight plaintext"><code>San Francisco on 1994-11-27: low: 46, high: 50, precipitation: Optional(0.25)
San Francisco on 1994-11-29: low: 43, high: 57, precipitation: Optional(0.0)
</code></pre>
<h2 id='prerequisites' class='heading'>Prerequisites</h2>

<ul>
<li><strong>Swift 5 or later</strong>  (PostgresClientKit uses Swift 5 language features)</li>
<li><strong><code>libssl-dev</code></strong> (only required on Linux, and only for SSL/TLS connections)</li>
</ul>
<h3 id='certifications' class='heading'>Certifications</h3>

<p>PostgresClientKit has been tested in the following environments:</p>

<ul>
<li>macOS: [TODO]</li>
<li>iOS: [TODO]</li>
<li>Linux: [TODO]</li>
</ul>

<p>Other environments may also work, but they have not been certified.</p>
<h2 id='building' class='heading'>Building</h2>
<pre class="highlight plaintext"><code>cd &lt;path-to-clone&gt;
swift package clean
swift build
</code></pre>
<h2 id='testing' class='heading'>Testing</h2>
<pre class="highlight plaintext"><code>cd &lt;path-to-clone&gt;
swift package clean
swift build
swift test
</code></pre>
<h2 id='using' class='heading'>Using</h2>
<h3 id='including-in-your-project' class='heading'>Including in your project</h3>
<h4 id='swift-package-manager' class='heading'>Swift Package Manager</h4>

<p>In your <code>Package.swift</code> file:</p>

<ul>
<li>Add PostgresClientKit to the <code>dependencies</code>.  For example:</li>
</ul>

<p>[TODO: update URL and version number]</p>
<pre class="highlight swift"><code><span class="nv">dependencies</span><span class="p">:</span> <span class="p">[</span>
    <span class="o">.</span><span class="nf">package</span><span class="p">(</span><span class="nv">url</span><span class="p">:</span> <span class="s">"https://github.com/pitfield/PostgresClientKit"</span><span class="p">,</span> <span class="nv">from</span><span class="p">:</span> <span class="s">"0.0.0"</span><span class="p">),</span>
<span class="p">],</span>
</code></pre>

<ul>
<li>Reference the <code>PostgresClientKit</code> product in the <code>targets</code>.  For example:</li>
</ul>
<pre class="highlight swift"><code><span class="nv">targets</span><span class="p">:</span> <span class="p">[</span>
    <span class="o">.</span><span class="nf">target</span><span class="p">(</span>
        <span class="nv">name</span><span class="p">:</span> <span class="s">"MyProject"</span><span class="p">,</span>
        <span class="nv">dependencies</span><span class="p">:</span> <span class="p">[</span><span class="s">"PostgresClientKit"</span><span class="p">]),</span>
<span class="p">]</span>
</code></pre>
<h4 id='cocoapods' class='heading'>CocoaPods</h4>

<p>[TODO]</p>
<h3 id='importing-to-your-source-code-file' class='heading'>Importing to your source code file</h3>
<pre class="highlight swift"><code><span class="kd">import</span> <span class="kt">PostgresClientKit</span>
</code></pre>
<h3 id='documentation' class='heading'>Documentation</h3>

<ul>
<li><a href="Docs/index.html">API documentation</a></li>
<li><a href="Docs/Troubleshooting.md">Troubleshooting</a></li>
<li><a href="Docs/FAQ.md">FAQ</a></li>
</ul>
<h3 id='examples' class='heading'>Examples</h3>
<h4 id='playgrounds' class='heading'>Playgrounds</h4>

<p>[TODO]</p>
<h4 id='repositories-xcode-projects' class='heading'>Repositories / Xcode projects</h4>

<p>[TODO]</p>
<h3 id='troubleshooting' class='heading'>Troubleshooting</h3>

<p>[TODO]</p>

<ul>
<li>Using logging</li>
</ul>
<h3 id='faq' class='heading'>FAQ</h3>

<p>[TODO]</p>

<ul>
<li>Why are the PostgresClientKit APIs synchronous?</li>
<li>Does PostgresClientKit provide connection pooling?</li>
<li>Why can&rsquo;t I reference a column in a <code><a href="Structs/Row.html">Row</a></code> by name, instead of by index?</li>
<li>In retrieving the value of a column, why do I need to specify the Swift type?</li>
</ul>
<h3 id='contributing' class='heading'>Contributing</h3>

<p>[TODO]</p>

<ul>
<li>Code of conduct</li>
<li>Requesting help</li>
<li>Raising issues</li>
<li>Pull requests</li>
</ul>
<h3 id='license' class='heading'>License</h3>

<p>PostgresClientKit is licensed under the Apache 2.0 license.  See <a href="LICENSE">LICENSE</a> for details.</p>
<h3 id='versioning' class='heading'>Versioning</h3>

<p>PostgresClientKit uses <a href="https://semver.org">Semantic Versioning 2.0.0</a>.  For the versions available, see the <a href="../../tags">tags on this repository</a>.</p>
<h3 id='built-with' class='heading'>Built with</h3>

<ul>
<li><a href="https://github.com/IBM-Swift/BlueSocket">Kitura BlueSocket</a> - socket library</li>
<li><a href="https://github.com/IBM-Swift/BlueSSLService">Kitura BlueSSLService</a> - SSL/TLS support</li>
<li><a href="https://github.com/realm/jazzy">Jazzy</a> - generation of API documentation pages</li>
</ul>
<h3 id='authors' class='heading'>Authors</h3>

<ul>
<li>David Pitfield <a href="https://github.com/pitfield">(@pitfield)</a></li>
</ul>

            </section>
          </section>
        </article>
      </div>
      <div class="nav-wrapper">
        <nav class="nav-bottom">
          <ul class="nav-groups">
            <li class="nav-group-name">
              <a href="Classes.html">Classes</a>
              <ul class="nav-group-tasks">
                <li class="nav-group-task">
                  <a href="Classes/Connection.html">Connection</a>
                </li>
                <li class="nav-group-task">
                  <a href="Classes/ConsoleLogHandler.html">ConsoleLogHandler</a>
                </li>
                <li class="nav-group-task">
                  <a href="Classes/Cursor.html">Cursor</a>
                </li>
                <li class="nav-group-task">
                  <a href="Classes/Logger.html">Logger</a>
                </li>
                <li class="nav-group-task">
                  <a href="Classes/Statement.html">Statement</a>
                </li>
              </ul>
            </li>
            <li class="nav-group-name">
              <a href="Enums.html">Enumerations</a>
              <ul class="nav-group-tasks">
                <li class="nav-group-task">
                  <a href="Enums/Credential.html">Credential</a>
                </li>
                <li class="nav-group-task">
                  <a href="Enums/LogLevel.html">LogLevel</a>
                </li>
                <li class="nav-group-task">
                  <a href="Enums/PostgresError.html">PostgresError</a>
                </li>
              </ul>
            </li>
            <li class="nav-group-name">
              <a href="Extensions.html">Extensions</a>
              <ul class="nav-group-tasks">
                <li class="nav-group-task">
                  <a href="Extensions/Bool.html">Bool</a>
                </li>
                <li class="nav-group-task">
                  <a href="Extensions/Date.html">Date</a>
                </li>
                <li class="nav-group-task">
                  <a href="Extensions/Decimal.html">Decimal</a>
                </li>
                <li class="nav-group-task">
                  <a href="Extensions/Double.html">Double</a>
                </li>
                <li class="nav-group-task">
                  <a href="Extensions/Int.html">Int</a>
                </li>
                <li class="nav-group-task">
                  <a href="Extensions/Optional.html">Optional</a>
                </li>
                <li class="nav-group-task">
                  <a href="Extensions/String.html">String</a>
                </li>
              </ul>
            </li>
            <li class="nav-group-name">
              <a href="Protocols.html">Protocols</a>
              <ul class="nav-group-tasks">
                <li class="nav-group-task">
                  <a href="Protocols/ConnectionDelegate.html">ConnectionDelegate</a>
                </li>
                <li class="nav-group-task">
                  <a href="Protocols/LogHandler.html">LogHandler</a>
                </li>
                <li class="nav-group-task">
                  <a href="Protocols/PostgresValueConvertible.html">PostgresValueConvertible</a>
                </li>
              </ul>
            </li>
            <li class="nav-group-name">
              <a href="Structs.html">Structures</a>
              <ul class="nav-group-tasks">
                <li class="nav-group-task">
                  <a href="Structs/ConnectionConfiguration.html">ConnectionConfiguration</a>
                </li>
                <li class="nav-group-task">
                  <a href="Structs/LogRecord.html">LogRecord</a>
                </li>
                <li class="nav-group-task">
                  <a href="Structs/Notice.html">Notice</a>
                </li>
                <li class="nav-group-task">
                  <a href="Structs/Postgres.html">Postgres</a>
                </li>
                <li class="nav-group-task">
                  <a href="Structs/PostgresByteA.html">PostgresByteA</a>
                </li>
                <li class="nav-group-task">
                  <a href="Structs/PostgresDate.html">PostgresDate</a>
                </li>
                <li class="nav-group-task">
                  <a href="Structs/PostgresTime.html">PostgresTime</a>
                </li>
                <li class="nav-group-task">
                  <a href="Structs/PostgresTimeWithTimeZone.html">PostgresTimeWithTimeZone</a>
                </li>
                <li class="nav-group-task">
                  <a href="Structs/PostgresTimestamp.html">PostgresTimestamp</a>
                </li>
                <li class="nav-group-task">
                  <a href="Structs/PostgresTimestampWithTimeZone.html">PostgresTimestampWithTimeZone</a>
                </li>
                <li class="nav-group-task">
                  <a href="Structs/PostgresValue.html">PostgresValue</a>
                </li>
                <li class="nav-group-task">
                  <a href="Structs/Row.html">Row</a>
                </li>
              </ul>
            </li>
          </ul>
        </nav>
      </div>
      <div class="footer-wrapper">
        <section id="footer">
          <p>Copyright 2019 David Pitfield and the PostgresClientKit contributors. Licensed under the Apache License, Version 2.0.</p>
          <p>Generated by <a class="link" href="https://github.com/realm/jazzy" target="_blank" rel="external">jazzy ♪♫ v0.9.5</a>, a <a class="link" href="https://realm.io" target="_blank" rel="external">Realm</a> project.</p>
        </section>
      </div>
    </div>
  </body>
</div>
</html>
